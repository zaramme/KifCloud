function apiLoadKifu(e){fileurl="/api/kifu/"+e,debug("api通信：api.kifu param ... "+e),$.ajax({url:fileurl,dataType:"json",success:function(e){debug("--棋譜が読み込まれました"),setMoveList(e)}})}function apiGetKifuInit(e){var t="api/board/";$.ajax({url:t,dataType:"json"}).done(function(t){e(t)}).fail(function(){console.log("apiロードに失敗しました。resource= "+rsh)})}function clearKifu(){var e=$("#PanelMoveList").children("select"),t=e.children();t.remove()}function setKifuWithJson(e){clearKifu(),e=e.json,apiGetKifuInit(function(t){pushKifuNode({RshCurrent:t.Info.RshCurrent,MoveText:"(開始局面)"});for(var a=0,o=e.length;o>a;a++)$("#PanelMoveList").children("select").append($("<option>").html(e[a].MoveText).attr({"data-RshCurrent":e[a].RshCurrent,"data-RshPrev":e[a].RshPrev,"data-LastMoveCode":e[a].LastMoveCode,"data-LastJsCode":e[a].LastJsCode}))})}function pushKifuNode(e){var t=$("<option>").html(e.MoveText).attr({"data-RshCurrent":e.RshCurrent,"data-RshPrev":e.RshPrev,"data-LastJsCode":e.LastJsCode,"data-LastMoveCode":e.LastMoveCode}),a=$("#PanelMoveList").children("select"),o=a.children(":selected");if(0==o.length)$("#PanelMoveList").children("select").append(t),$("#PanelMoveList").children("select").children().prop("selected",!0);else{var s=a.children(":selected").nextAll();s.remove(),o.after(t),o.next().prop("selected",!0)}o.prop("checked",!1)}function setMoveList(e){for(var t=0,a=e.length;a>t;t++)$("#PanelMoveList").children("select").append($("<option>").html(e[t].MoveText).attr({"data-RshCurrent":e[t].RshCurrent,"data-RshPrev":e[t].RshPrev,"data-LastMoveCode":e[t].LastMoveCode,"data-LastJsCode":e[t].LastJsCode}))}function SetBoardTrigger(e){$("#jsBoard").trigger("setBoard",e)}$(function(){debug("jsKifu/api.jsを読み込みました")}),$(function(){debug("jsKifu/controller.jsを読み込みました"),$("#PanelMoveList").ready(function(){}),$("#PanelMoveList").on("pushKifuNode",function(e,t){pushKifuNode(t)}),$("#PanelMoveList").on("loadKifuWithJson",function(e,t){setKifuWithJson(t)}),$("#PanelMoveList").children("select").change(function(){var e=$(this).children(":selected"),t=e.attr("data-LastJsCode");if(void 0==e.attr("data-LastJsCode")||void 0==e.attr("data-LastMoveCode"))var a=e.attr("data-RshCurrent");else if("END_OF_GAME"==t){e=e.prev();var a=e.attr("data-RshPrev"),o=e.attr("data-LastJsCode"),s=e.attr("data-LastMoveCode")}else var a=e.attr("data-RshPrev"),o=e.attr("data-LastJsCode"),s=e.attr("data-LastMoveCode");obj={rsh:a,LastJsCode:o,LastMoveCode:s},SetBoardTrigger(obj)})});